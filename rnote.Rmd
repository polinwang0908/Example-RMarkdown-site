---
title: "R Note"
output:
  html_document:
    toc: true
    toc_float: true

---
**************
## Fixed Effect \& Clustering

Two ways of getting fixed effect estimation and clustering standard errors: `plm` and `felm`. They are consistent when one way fixed effect, and are slightly different in degree of freedom adjustment when multiple dimension fixed effect.
```{r, message=FALSE, warning=FALSE,echo=TRUE,include=TRUE}
# Loading the required libraries
library(plm)
library(lmtest)
library(multiwayvcov)
library(lfe)
library(stargazer)
# Loading Petersen's dataset
data(petersen)

# Pooled OLS model
pooled.ols<-plm(y~x,data=petersen,model="pooling",index=c("firmid", "year"))

# Fixed effects model
fe.firm<-plm(y~x,data=petersen,model="within",index=c("firmid", "year"))
```

```{r, results="asis"}

# Clustered standard errors - OLS (by firm)
stargazer(coeftest(pooled.ols,vcov=vcovHC(pooled.ols,type="sss",cluster="group")),
          felm(y~x|0|0|firmid,data=petersen),type='html')

# Clustered standard errors - OLS (by time)
stargazer(coeftest(pooled.ols,vcov=vcovHC(pooled.ols,type="sss",cluster="time")),
          felm(y~x|0|0|year,data=petersen),type='html')

# Clustered standard errors - OLS (by firm and time)
stargazer(coeftest(pooled.ols,vcov=vcovDC(pooled.ols,type="sss")),
          felm(y~x|0|0|firmid+year,data=petersen),type='html')

# Clustered standard errors - Fixed effect regression (by firm)
stargazer(coeftest(fe.firm,vcov=vcovHC(fe.firm,type="sss",cluster="group")),
          felm(y~x|firmid|0|firmid,data=petersen),type='html')

# Clustered standard errors - Fixed effect regression (by time)
stargazer(coeftest(fe.firm,vcov=vcovHC(fe.firm,type="sss",cluster="time")),
          felm(y~x|firmid|0|year,data=petersen),type='html')

# Clustered standard errors - Fixed effect regression (by firm and time)
stargazer(coeftest(fe.firm,vcov=vcovDC(fe.firm,type="sss")),
          felm(y~x|firmid|0|firmid+year,data=petersen),type='html')

```

**************

## Debugging

- Function to trace back to upper level: `recover()`.

**************

## R Markdown Note

- Link: `[link](http://xxxx.com)`
- Quote: `>abc`
- Numbered header `#.`
